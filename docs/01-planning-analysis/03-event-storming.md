# ã‚¤ãƒ™ãƒ³ãƒˆã‚¹ãƒˆãƒ¼ãƒŸãƒ³ã‚°è¨­è¨ˆæ›¸

## 1. ãƒ“ãƒƒã‚°ãƒ”ã‚¯ãƒãƒ£ãƒ¼

### 1.1 ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆå…¨ä½“å›³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    EVENT STORMING - BIG PICTURE                              â”‚
â”‚                                                                              â”‚
â”‚  Timeline â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ AUDIO PROCESSING FLOW                                                    â”‚â”‚
â”‚  â”‚                                                                          â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚â”‚
â”‚  â”‚  â”‚ğŸŸ§ Audio   â”‚â”€â”€â–¶â”‚ğŸŸ§ Audio   â”‚â”€â”€â–¶â”‚ğŸŸ§ Trans-  â”‚â”€â”€â–¶â”‚ğŸŸ§ Sentimentâ”‚           â”‚â”‚
â”‚  â”‚  â”‚  Uploaded â”‚   â”‚  Processingâ”‚   â”‚  cription â”‚   â”‚  Analyzed â”‚           â”‚â”‚
â”‚  â”‚  â”‚          â”‚   â”‚  Started  â”‚   â”‚  Completedâ”‚   â”‚          â”‚            â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚â”‚
â”‚  â”‚       â”‚                                             â”‚                    â”‚â”‚
â”‚  â”‚       â–¼                                             â–¼                    â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚â”‚
â”‚  â”‚  â”‚ğŸŸ¦ Upload  â”‚                                â”‚ğŸŸ¦ Create  â”‚              â”‚â”‚
â”‚  â”‚  â”‚  Audio   â”‚                                 â”‚  Embeddingâ”‚              â”‚â”‚
â”‚  â”‚  â”‚          â”‚                                 â”‚          â”‚              â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ VIDEO PROCESSING FLOW                                                    â”‚â”‚
â”‚  â”‚                                                                          â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚â”‚
â”‚  â”‚  â”‚ğŸŸ§ Video   â”‚â”€â”€â–¶â”‚ğŸŸ§ Frame   â”‚â”€â”€â–¶â”‚ğŸŸ§ Anomaly â”‚â”€â”€â–¶â”‚ğŸŸ§ Alert   â”‚            â”‚â”‚
â”‚  â”‚  â”‚  Uploaded â”‚   â”‚  Analyzed â”‚   â”‚  Detected â”‚   â”‚  Sent    â”‚            â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚â”‚
â”‚  â”‚       â”‚              â”‚                              â”‚                    â”‚â”‚
â”‚  â”‚       â–¼              â–¼                              â–¼                    â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚â”‚
â”‚  â”‚  â”‚ğŸŸ¦ Upload  â”‚  â”‚ğŸŸ© Check   â”‚                   â”‚ğŸŸª Quality â”‚             â”‚â”‚
â”‚  â”‚  â”‚  Video   â”‚  â”‚  Thresholdâ”‚                   â”‚  Manager â”‚             â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ AGENT INTERACTION FLOW                                                   â”‚â”‚
â”‚  â”‚                                                                          â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚â”‚
â”‚  â”‚  â”‚ğŸŸ§ Session â”‚â”€â”€â–¶â”‚ğŸŸ§ User    â”‚â”€â”€â–¶â”‚ğŸŸ§ Intent  â”‚â”€â”€â–¶â”‚ğŸŸ§ Tool    â”‚            â”‚â”‚
â”‚  â”‚  â”‚  Started â”‚   â”‚  Message  â”‚   â”‚  Recognizedâ”‚  â”‚  Executedâ”‚            â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  Received â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚â”‚
â”‚  â”‚       â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚              â”‚                    â”‚â”‚
â”‚  â”‚       â–¼              â”‚               â–¼              â–¼                    â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚â”‚
â”‚  â”‚  â”‚ğŸŸª User   â”‚        â”‚         â”‚ğŸŸ¦ Search  â”‚   â”‚ğŸŸ§ Responseâ”‚            â”‚â”‚
â”‚  â”‚  â”‚          â”‚        â”‚         â”‚  Knowledgeâ”‚   â”‚  Generatedâ”‚            â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚â”‚
â”‚  â”‚                      â–¼                                                   â”‚â”‚
â”‚  â”‚                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                             â”‚â”‚
â”‚  â”‚                 â”‚ğŸŸ¦ Transcribe                                           â”‚â”‚
â”‚  â”‚                 â”‚  Audio   â”‚                                             â”‚â”‚
â”‚  â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                             â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                              â”‚
â”‚  Legend:                                                                     â”‚
â”‚  ğŸŸ§ Domain Event    ğŸŸ¦ Command    ğŸŸ© Policy    ğŸŸª Actor    ğŸŸ¨ Aggregate      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 2. ãƒ—ãƒ­ã‚»ã‚¹ãƒ¢ãƒ‡ãƒªãƒ³ã‚°

### 2.1 éŸ³å£°å‡¦ç†ãƒ—ãƒ­ã‚»ã‚¹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AUDIO PROCESSING PROCESS                                  â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                               â”‚
â”‚  â”‚ğŸŸª Operatorâ”‚                                                               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                                                               â”‚
â”‚        â”‚                                                                     â”‚
â”‚        â–¼                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                           â”‚
â”‚  â”‚ğŸŸ¦ Upload Audioâ”‚                                                           â”‚
â”‚  â”‚              â”‚                                                           â”‚
â”‚  â”‚ â€¢ audioFile  â”‚                                                           â”‚
â”‚  â”‚ â€¢ userId     â”‚                                                           â”‚
â”‚  â”‚ â€¢ metadata   â”‚                                                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                                           â”‚
â”‚         â”‚                                                                    â”‚
â”‚         â–¼                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”‚
â”‚  â”‚ğŸŸ¨ AudioFile   â”‚â”€â”€â”€â”€â”€â–¶â”‚ğŸŸ§ AudioUploadedâ”‚                                    â”‚
â”‚  â”‚              â”‚      â”‚              â”‚                                     â”‚
â”‚  â”‚ id           â”‚      â”‚ audioId      â”‚                                     â”‚
â”‚  â”‚ s3Key        â”‚      â”‚ s3Key        â”‚                                     â”‚
â”‚  â”‚ status       â”‚      â”‚ timestamp    â”‚                                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
â”‚                               â”‚                                              â”‚
â”‚                               â”‚ triggers                                     â”‚
â”‚                               â–¼                                              â”‚
â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”‚
â”‚                        â”‚ğŸŸ© On Audio    â”‚                                     â”‚
â”‚                        â”‚   Uploaded   â”‚                                     â”‚
â”‚                        â”‚              â”‚                                     â”‚
â”‚                        â”‚ START        â”‚                                     â”‚
â”‚                        â”‚ PROCESSING   â”‚                                     â”‚
â”‚                        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
â”‚                               â”‚                                              â”‚
â”‚                               â–¼                                              â”‚
â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”‚
â”‚                        â”‚ğŸŸ¦ Start       â”‚                                     â”‚
â”‚                        â”‚  Processing  â”‚                                     â”‚
â”‚                        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
â”‚                               â”‚                                              â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚         â”‚                     â”‚                     â”‚                       â”‚
â”‚         â–¼                     â–¼                     â–¼                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚ğŸŸ¦ Transcribe  â”‚      â”‚ğŸŸ¦ Analyze     â”‚      â”‚ğŸŸ¦ Detect      â”‚              â”‚
â”‚  â”‚  Audio       â”‚      â”‚  Sentiment   â”‚      â”‚  Speakers    â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚         â”‚                     â”‚                     â”‚                       â”‚
â”‚         â–¼                     â–¼                     â–¼                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚ğŸŸ§ Transcriptionâ”‚     â”‚ğŸŸ§ Sentiment   â”‚      â”‚ğŸŸ§ Speakers   â”‚              â”‚
â”‚  â”‚  Completed   â”‚      â”‚  Analyzed    â”‚      â”‚  Detected   â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚         â”‚                     â”‚                     â”‚                       â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                               â”‚                                              â”‚
â”‚                               â–¼                                              â”‚
â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”‚
â”‚                        â”‚ğŸŸ© When All    â”‚                                     â”‚
â”‚                        â”‚  Complete    â”‚                                     â”‚
â”‚                        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
â”‚                               â”‚                                              â”‚
â”‚                               â–¼                                              â”‚
â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”‚
â”‚                        â”‚ğŸŸ§ Audio       â”‚                                     â”‚
â”‚                        â”‚  Processing  â”‚                                     â”‚
â”‚                        â”‚  Completed   â”‚                                     â”‚
â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 Agent ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ­ã‚»ã‚¹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AGENT INTERACTION PROCESS                                 â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                               â”‚
â”‚  â”‚ğŸŸª User    â”‚                                                               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                                                               â”‚
â”‚        â”‚                                                                     â”‚
â”‚        â–¼                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”‚
â”‚  â”‚ğŸŸ¦ Start       â”‚â”€â”€â”€â”€â”€â–¶â”‚ğŸŸ¨ AgentSessionâ”‚                                     â”‚
â”‚  â”‚  Session     â”‚      â”‚              â”‚                                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚ id           â”‚                                     â”‚
â”‚                        â”‚ userId       â”‚                                     â”‚
â”‚                        â”‚ conversation â”‚                                     â”‚
â”‚                        â”‚ context      â”‚                                     â”‚
â”‚                        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
â”‚                               â”‚                                              â”‚
â”‚                               â–¼                                              â”‚
â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”‚
â”‚                        â”‚ğŸŸ§ Session     â”‚                                     â”‚
â”‚                        â”‚  Started     â”‚                                     â”‚
â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”  â”‚
â”‚  â”‚                    CONVERSATION LOOP                                  â”‚  â”‚
â”‚                                                                              â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                          â”‚  â”‚
â”‚    â”‚ğŸŸ¦ Send     â”‚                                                            â”‚
â”‚  â”‚ â”‚  Message  â”‚                                                          â”‚  â”‚
â”‚    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                                                              â”‚
â”‚  â”‚       â”‚                                                                â”‚  â”‚
â”‚          â–¼                                                                   â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                       â”‚  â”‚
â”‚    â”‚ğŸŸ§ User Messageâ”‚                                                         â”‚
â”‚  â”‚ â”‚  Received   â”‚                                                        â”‚  â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                                          â”‚
â”‚  â”‚        â”‚                                                               â”‚  â”‚
â”‚           â”‚ triggers                                                         â”‚
â”‚  â”‚        â–¼                                                               â”‚  â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                          â”‚
â”‚  â”‚ â”‚ğŸŸ© On Message  â”‚                                                       â”‚  â”‚
â”‚    â”‚  Received   â”‚                                                           â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                                       â”‚  â”‚
â”‚           â”‚                                                                  â”‚
â”‚  â”‚        â–¼                                                               â”‚  â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â”‚
â”‚  â”‚ â”‚ğŸŸ¦ Recognize   â”‚â”€â”€â”€â”€â”€â–¶â”‚ğŸŸ§ Intent      â”‚                                 â”‚  â”‚
â”‚    â”‚  Intent     â”‚      â”‚  Recognized  â”‚                                     â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚  â”‚
â”‚                                 â”‚                                            â”‚
â”‚  â”‚                              â”‚ triggers                                â”‚  â”‚
â”‚                                 â–¼                                            â”‚
â”‚  â”‚                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚  â”‚
â”‚                          â”‚ğŸŸ© Select Tool â”‚                                   â”‚
â”‚  â”‚                       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚  â”‚
â”‚                                 â”‚                                            â”‚
â”‚  â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚  â”‚
â”‚                       â”‚         â”‚         â”‚                                  â”‚
â”‚  â”‚                    â–¼         â–¼         â–¼                               â”‚  â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚  â”‚ â”‚ğŸŸ¦ Search      â”‚ â”‚ğŸŸ¦ Transcribeâ”‚ â”‚ğŸŸ¦ Analyze     â”‚                       â”‚  â”‚
â”‚    â”‚  Knowledge  â”‚ â”‚  Audio    â”‚ â”‚  Video      â”‚                             â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚  â”‚
â”‚           â”‚               â”‚              â”‚                                   â”‚
â”‚  â”‚        â–¼               â–¼              â–¼                               â”‚  â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚  â”‚ â”‚ğŸŸ§ Tool        â”‚ â”‚ğŸŸ§ Tool      â”‚ â”‚ğŸŸ§ Tool        â”‚                       â”‚  â”‚
â”‚    â”‚  Executed   â”‚ â”‚  Executed â”‚ â”‚  Executed   â”‚                             â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚  â”‚
â”‚           â”‚               â”‚              â”‚                                   â”‚
â”‚  â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚  â”‚
â”‚                           â”‚                                                  â”‚
â”‚  â”‚                        â–¼                                               â”‚  â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                          â”‚
â”‚  â”‚                 â”‚ğŸŸ¦ Generate    â”‚                                       â”‚  â”‚
â”‚                    â”‚  Response   â”‚                                           â”‚
â”‚  â”‚                 â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                       â”‚  â”‚
â”‚                           â”‚                                                  â”‚
â”‚  â”‚                        â–¼                                               â”‚  â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                          â”‚
â”‚  â”‚                 â”‚ğŸŸ§ Response    â”‚                                       â”‚  â”‚
â”‚                    â”‚  Generated  â”‚                                           â”‚
â”‚  â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                       â”‚  â”‚
â”‚                                                                              â”‚
â”‚  â”” â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”˜  â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”‚
â”‚  â”‚ğŸŸ¦ End Session â”‚â”€â”€â”€â”€â”€â–¶â”‚ğŸŸ§ Session     â”‚                                     â”‚
â”‚  â”‚              â”‚      â”‚  Terminated  â”‚                                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 3. ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆä¸€è¦§

### 3.1 Audio Context

| Event | Trigger | Data | Consumers |
|-------|---------|------|-----------|
| AudioUploaded | Upload Command | audioId, s3Key, userId | AudioProcessor |
| AudioProcessingStarted | Policy | audioId | Monitoring |
| TranscriptionCompleted | Nova Sonic | audioId, text, confidence | SearchIndexer, Agent |
| SentimentAnalyzed | Analysis | audioId, sentiment | Analytics |
| SpeakersDetected | Analysis | audioId, speakers[] | Analytics |
| AudioProcessingCompleted | Policy | audioId | Notification |
| AudioProcessingFailed | Error | audioId, reason | Alerting |

### 3.2 Video Context

| Event | Trigger | Data | Consumers |
|-------|---------|------|-----------|
| VideoUploaded | Upload Command | videoId, s3Key | VideoProcessor |
| FrameAnalyzed | Nova Omni | videoId, frameId, objects | Monitoring |
| AnomalyDetected | Analysis | videoId, anomaly, confidence | Alerting, QC |
| AlertSent | Policy | videoId, alertId | Notification |
| VideoProcessingCompleted | Policy | videoId | Analytics |

### 3.3 Agent Context

| Event | Trigger | Data | Consumers |
|-------|---------|------|-----------|
| SessionStarted | Start Command | sessionId, userId | Analytics |
| UserMessageReceived | User Input | sessionId, content | AgentOrchestrator |
| IntentRecognized | NLU | sessionId, intent, entities | ToolSelector |
| ToolExecuted | Tool Call | sessionId, toolName, result | ResponseGenerator |
| ResponseGenerated | Generation | sessionId, content | User |
| SessionTerminated | End Command | sessionId, turnCount | Analytics |

### 3.4 Search Context

| Event | Trigger | Data | Consumers |
|-------|---------|------|-----------|
| DocumentIndexed | Index Command | docId, embedding | SearchEngine |
| EmbeddingCreated | Nova Embeddings | contentId, vector | SearchIndex |
| SearchExecuted | Search Command | queryId, results | Analytics |

## 4. ã‚³ãƒãƒ³ãƒ‰ãƒ»ãƒãƒªã‚·ãƒ¼ãƒãƒƒãƒ”ãƒ³ã‚°

```yaml
# Command -> Event -> Policy -> Command Chain

UploadAudio:
  produces: AudioUploaded
  triggers:
    - policy: OnAudioUploaded
      command: StartAudioProcessing

StartAudioProcessing:
  produces: AudioProcessingStarted
  triggers:
    - policy: ProcessingStarted
      commands:
        - TranscribeAudio
        - AnalyzeSentiment
        - DetectSpeakers

TranscribeAudio:
  produces: TranscriptionCompleted
  triggers:
    - policy: OnTranscriptionCompleted
      command: CreateEmbedding

CreateEmbedding:
  produces: EmbeddingCreated
  triggers:
    - policy: OnEmbeddingCreated
      command: IndexDocument

# Agent Flow
SendMessage:
  produces: UserMessageReceived
  triggers:
    - policy: OnMessageReceived
      command: RecognizeIntent

RecognizeIntent:
  produces: IntentRecognized
  triggers:
    - policy: SelectTool
      commands:
        - SearchKnowledge   # if intent=search
        - TranscribeAudio   # if intent=transcribe
        - AnalyzeVideo      # if intent=analyze

ExecuteTool:
  produces: ToolExecuted
  triggers:
    - policy: OnToolExecuted
      command: GenerateResponse

GenerateResponse:
  produces: ResponseGenerated
  triggers:
    - policy: OnResponseGenerated
      command: SendToUser
```

## 5. ã‚¢ã‚°ãƒªã‚²ãƒ¼ãƒˆå¢ƒç•Œ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AGGREGATE BOUNDARIES                                      â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                     AudioFile Aggregate                              â”‚    â”‚
â”‚  â”‚                                                                      â”‚    â”‚
â”‚  â”‚   Root: AudioFile                                                    â”‚    â”‚
â”‚  â”‚   â”œâ”€â”€ Transcription (Entity)                                        â”‚    â”‚
â”‚  â”‚   â”‚   â””â”€â”€ TranscriptSegment[] (VO)                                  â”‚    â”‚
â”‚  â”‚   â”œâ”€â”€ SentimentScore (VO)                                           â”‚    â”‚
â”‚  â”‚   â””â”€â”€ AudioMetadata (VO)                                            â”‚    â”‚
â”‚  â”‚                                                                      â”‚    â”‚
â”‚  â”‚   Invariants:                                                        â”‚    â”‚
â”‚  â”‚   â€¢ Status transitions must follow state machine                    â”‚    â”‚
â”‚  â”‚   â€¢ Transcription only allowed in PROCESSING state                  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                     AgentSession Aggregate                           â”‚    â”‚
â”‚  â”‚                                                                      â”‚    â”‚
â”‚  â”‚   Root: AgentSession                                                 â”‚    â”‚
â”‚  â”‚   â”œâ”€â”€ Conversation (Entity)                                         â”‚    â”‚
â”‚  â”‚   â”‚   â”œâ”€â”€ Message[] (VO)                                            â”‚    â”‚
â”‚  â”‚   â”‚   â””â”€â”€ ToolCall[] (VO)                                           â”‚    â”‚
â”‚  â”‚   â””â”€â”€ AgentContext (VO)                                             â”‚    â”‚
â”‚  â”‚                                                                      â”‚    â”‚
â”‚  â”‚   Invariants:                                                        â”‚    â”‚
â”‚  â”‚   â€¢ Messages only allowed in ACTIVE state                           â”‚    â”‚
â”‚  â”‚   â€¢ TTL must be extended on activity                                â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                     SearchIndex Aggregate                            â”‚    â”‚
â”‚  â”‚                                                                      â”‚    â”‚
â”‚  â”‚   Root: SearchIndex                                                  â”‚    â”‚
â”‚  â”‚   â”œâ”€â”€ IndexedDocument[] (Entity)                                    â”‚    â”‚
â”‚  â”‚   â”‚   â””â”€â”€ Embedding (VO)                                            â”‚    â”‚
â”‚  â”‚   â””â”€â”€ IndexMetadata (VO)                                            â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

